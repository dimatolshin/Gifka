import{r as P,j as v,k as nt,l as Oe,i as ot,u as Re,g as at,R as rt,d as st}from"./index-7ad44c02.js";import{b as ae,a as oe,q as k,u as it}from"./queryClient-3cd3dac9.js";import{B as Z}from"./Button-f74cba7e.js";import"./Modal.module-7cebd6cd.js";import{u as lt}from"./useQuery-713eda4e.js";import{_ as be}from"./index-bccc6145.js";import{a as ct}from"./staticGif-d433252a.js";import{L as ut}from"./ListBox-51c60d8b.js";const dt="_adminPanelBlock_e9yg1_1",ft={adminPanelBlock:dt},re="https://bwcreatorhub.com";function pt(e){return ae.post(`${re}/api/load_picture/`,e).then(()=>{})}function ht(){return ae.get(`${re}/api/all_picture/`).then(e=>e.data).catch(e=>{const t=Object.keys(e.response.data).map(n=>`${e.response.data[n]}`).join(", ");throw new Error(t)})}const gt=(e,t,n,o,r,s,c,l,d,y,S,b)=>ae.post(`${re}/api/createFullPicture/`,{picture_id:e,country:t,language:n,value:o,format:r,topic:s,color:c,left:l,right:d,top:y,bottom:S,size:b}).then(g=>g.data).catch(g=>{const C=Object.keys(g.response.data).map(N=>`${g.response.data[N]}`).join(", ");throw new Error(C)}),mt=(e,t,n,o,r,s,c,l,d,y,S,b)=>ae.post(`${re}/api/createFullPicture/`,{full_picture_id:e,country:t,language:n,value:o,format:r,topic:s,color:c,left:l,right:d,top:y,bottom:S,size:b}).then(g=>g.data).catch(g=>{const C=Object.keys(g.response.data).map(N=>`${g.response.data[N]}`).join(", ");throw new Error(C)}),vt=e=>ae.post(`${re}/api/get_is_publish/`,{full_picture_id:e}).then(t=>t.data).catch(t=>{const n=Object.keys(t.response.data).map(o=>`${t.response.data[o]}`).join(", ");throw new Error(n)});var w=[];for(var De=0;De<256;++De)w.push((De+256).toString(16).slice(1));function yt(e,t=0){return(w[e[t+0]]+w[e[t+1]]+w[e[t+2]]+w[e[t+3]]+"-"+w[e[t+4]]+w[e[t+5]]+"-"+w[e[t+6]]+w[e[t+7]]+"-"+w[e[t+8]]+w[e[t+9]]+"-"+w[e[t+10]]+w[e[t+11]]+w[e[t+12]]+w[e[t+13]]+w[e[t+14]]+w[e[t+15]]).toLowerCase()}var pe,St=new Uint8Array(16);function bt(){if(!pe&&(pe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pe(St)}var Dt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Me={randomUUID:Dt};function _t(e,t,n){if(Me.randomUUID&&!t&&!e)return Me.randomUUID();e=e||{};var o=e.random||(e.rng||bt)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=o[r];return t}return yt(o)}const Pt="_fileBlock_16uh2_1",Ct="_inputBlock_16uh2_8",wt="_hiddenInput_16uh2_14",xt="_customLabel_16uh2_18",Tt="_loadButton_16uh2_30",Nt="_deleteButton_16uh2_37",Mt="_selectedFile_16uh2_43",Bt="_selectedFilesList_16uh2_47",$={fileBlock:Pt,inputBlock:Ct,hiddenInput:wt,customLabel:xt,loadButton:Tt,deleteButton:Nt,selectedFile:Mt,selectedFilesList:Bt};function Et(){const e=P.useRef(null),[t,n]=P.useState([]),[o,r]=P.useState(null),s=S=>{const b=Array.from(S.target.files).map(g=>({id:_t(),file:g}));n(g=>[...g,...b]),r(b[b.length-1].file.name)},c=oe({mutationFn:S=>pt(S.formData),onSuccess:()=>{r(null),n([]),k.invalidateQueries({queryKey:["img"]})}},k),l=async()=>{if(t.length===0){alert("Файл не добавлен");return}const S=new FormData;t.forEach(({file:b})=>{S.append("photos",b)}),c.mutate({formData:S})},d=S=>{n(b=>{const g=b.filter(C=>C.id!==S);return g.length>0?r(g[g.length-1].file.name):r(null),g})},y=()=>{e.current.click()};return v.jsxs("div",{className:$.fileBlock,children:[v.jsxs("div",{className:$.inputBlock,children:[v.jsx("input",{type:"file",multiple:!0,onChange:s,className:$.hiddenInput,ref:e,accept:"image/*,.png,.jpg,.gif,.web,.jpeg,.svg"}),v.jsx("button",{onClick:y,className:$.customLabel,children:"Выбрать файлы"}),v.jsx(Z,{className:$.loadButton,onClick:l,children:"Загрузить"})]}),o&&v.jsxs("span",{className:$.fileName,children:["Последний загруженный файл: ",o]}),v.jsx("ul",{className:$.selectedFilesList,children:t.map(({id:S,file:b})=>v.jsxs("li",{children:[v.jsxs("p",{className:$.selectedFile,children:["Название файла: ",b.name]}),v.jsx(Z,{className:$.deleteButton,onClick:()=>d(S),children:"Удалить"})]},S))})]})}const Ot="_mainBox_p5ybv_1",Rt="_redactorBox_p5ybv_6",Ft="_draggableBox_p5ybv_12",It="_redactorImg_p5ybv_19",Ut="_redactorInput_p5ybv_23",jt="_publish_p5ybv_27",Lt="_topbar_p5ybv_34",kt="_topBtn_p5ybv_42",Xt="_defaultSelect_p5ybv_48",At="_lastDefaultSelect_p5ybv_55",Wt="_adminRedactorButton_p5ybv_59",Yt="_draggableImgBox_p5ybv_66",R={mainBox:Ot,redactorBox:Rt,draggableBox:Ft,redactorImg:It,redactorInput:Ut,publish:jt,topbar:Lt,topBtn:kt,defaultSelect:Xt,lastDefaultSelect:At,adminRedactorButton:Wt,draggableImgBox:Yt};var ge={exports:{}},Fe={},Ie={exports:{}},$t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ht=$t,Gt=Ht;function Ue(){}function je(){}je.resetWarningCache=Ue;var Vt=function(){function e(o,r,s,c,l,d){if(d!==Gt){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:je,resetWarningCache:Ue};return n.PropTypes=n,n};Ie.exports=Vt();var Le=Ie.exports;function ke(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=ke(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function Be(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=ke(e))&&(o&&(o+=" "),o+=t);return o}const qt=Object.freeze(Object.defineProperty({__proto__:null,clsx:Be,default:Be},Symbol.toStringTag,{value:"Module"})),zt=nt(qt);var D={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.dontSetMe=en;X.findInArray=Kt;X.int=Jt;X.isFunction=Zt;X.isNum=Qt;function Kt(e,t){for(let n=0,o=e.length;n<o;n++)if(t.apply(t,[e[n],n,e]))return e[n]}function Zt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function Qt(e){return typeof e=="number"&&!isNaN(e)}function Jt(e){return parseInt(e,10)}function en(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))}var z={};Object.defineProperty(z,"__esModule",{value:!0});z.browserPrefixToKey=Ae;z.browserPrefixToStyle=tn;z.default=void 0;z.getPrefix=Xe;const _e=["Moz","Webkit","O","ms"];function Xe(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!n||t in n)return"";for(let o=0;o<_e.length;o++)if(Ae(t,_e[o])in n)return _e[o];return""}function Ae(e,t){return t?"".concat(t).concat(nn(e)):e}function tn(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function nn(e){let t="",n=!0;for(let o=0;o<e.length;o++)n?(t+=e[o].toUpperCase(),n=!1):e[o]==="-"?n=!0:t+=e[o];return t}z.default=Xe();Object.defineProperty(D,"__esModule",{value:!0});D.addClassName=$e;D.addEvent=rn;D.addUserSelectStyles=vn;D.createCSSTransform=pn;D.createSVGTransform=hn;D.getTouch=gn;D.getTouchIdentifier=mn;D.getTranslation=we;D.innerHeight=un;D.innerWidth=dn;D.matchesSelector=Ye;D.matchesSelectorAndParentsTo=an;D.offsetXYFromParent=fn;D.outerHeight=ln;D.outerWidth=cn;D.removeClassName=He;D.removeEvent=sn;D.removeUserSelectStyles=yn;var F=X,Ee=on(z);function We(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(We=function(o){return o?n:t})(e)}function on(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=We(t);if(n&&n.has(e))return n.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s)){var c=r?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(o,s,c):o[s]=e[s]}return o.default=e,n&&n.set(e,o),o}let he="";function Ye(e,t){return he||(he=(0,F.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,F.isFunction)(e[n])})),(0,F.isFunction)(e[he])?e[he](t):!1}function an(e,t,n){let o=e;do{if(Ye(o,t))return!0;if(o===n)return!1;o=o.parentNode}while(o);return!1}function rn(e,t,n,o){if(!e)return;const r={capture:!0,...o};e.addEventListener?e.addEventListener(t,n,r):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function sn(e,t,n,o){if(!e)return;const r={capture:!0,...o};e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}function ln(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,F.int)(n.borderTopWidth),t+=(0,F.int)(n.borderBottomWidth),t}function cn(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,F.int)(n.borderLeftWidth),t+=(0,F.int)(n.borderRightWidth),t}function un(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,F.int)(n.paddingTop),t-=(0,F.int)(n.paddingBottom),t}function dn(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,F.int)(n.paddingLeft),t-=(0,F.int)(n.paddingRight),t}function fn(e,t,n){const r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),s=(e.clientX+t.scrollLeft-r.left)/n,c=(e.clientY+t.scrollTop-r.top)/n;return{x:s,y:c}}function pn(e,t){const n=we(e,t,"px");return{[(0,Ee.browserPrefixToKey)("transform",Ee.default)]:n}}function hn(e,t){return we(e,t,"")}function we(e,t,n){let{x:o,y:r}=e,s="translate(".concat(o).concat(n,",").concat(r).concat(n,")");if(t){const c="".concat(typeof t.x=="string"?t.x:t.x+n),l="".concat(typeof t.y=="string"?t.y:t.y+n);s="translate(".concat(c,", ").concat(l,")")+s}return s}function gn(e,t){return e.targetTouches&&(0,F.findInArray)(e.targetTouches,n=>t===n.identifier)||e.changedTouches&&(0,F.findInArray)(e.changedTouches,n=>t===n.identifier)}function mn(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function vn(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&$e(e.body,"react-draggable-transparent-selection")}function yn(e){if(e)try{if(e.body&&He(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch{}}function $e(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function He(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}var A={};Object.defineProperty(A,"__esModule",{value:!0});A.canDragX=Dn;A.canDragY=_n;A.createCoreData=Cn;A.createDraggableData=wn;A.getBoundPosition=Sn;A.getControlPosition=Pn;A.snapToGrid=bn;var O=X,Q=D;function Sn(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:o}=e.props;o=typeof o=="string"?o:xn(o);const r=xe(e);if(typeof o=="string"){const{ownerDocument:s}=r,c=s.defaultView;let l;if(o==="parent"?l=r.parentNode:l=s.querySelector(o),!(l instanceof c.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const d=l,y=c.getComputedStyle(r),S=c.getComputedStyle(d);o={left:-r.offsetLeft+(0,O.int)(S.paddingLeft)+(0,O.int)(y.marginLeft),top:-r.offsetTop+(0,O.int)(S.paddingTop)+(0,O.int)(y.marginTop),right:(0,Q.innerWidth)(d)-(0,Q.outerWidth)(r)-r.offsetLeft+(0,O.int)(S.paddingRight)-(0,O.int)(y.marginRight),bottom:(0,Q.innerHeight)(d)-(0,Q.outerHeight)(r)-r.offsetTop+(0,O.int)(S.paddingBottom)-(0,O.int)(y.marginBottom)}}return(0,O.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,O.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,O.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,O.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]}function bn(e,t,n){const o=Math.round(t/e[0])*e[0],r=Math.round(n/e[1])*e[1];return[o,r]}function Dn(e){return e.props.axis==="both"||e.props.axis==="x"}function _n(e){return e.props.axis==="both"||e.props.axis==="y"}function Pn(e,t,n){const o=typeof t=="number"?(0,Q.getTouch)(e,t):null;if(typeof t=="number"&&!o)return null;const r=xe(n),s=n.props.offsetParent||r.offsetParent||r.ownerDocument.body;return(0,Q.offsetXYFromParent)(o||e,s,n.props.scale)}function Cn(e,t,n){const o=!(0,O.isNum)(e.lastX),r=xe(e);return o?{node:r,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:r,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}}function wn(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}}function xn(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function xe(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}var me={},ve={};Object.defineProperty(ve,"__esModule",{value:!0});ve.default=Tn;function Tn(){}Object.defineProperty(me,"__esModule",{value:!0});me.default=void 0;var Pe=Mn(P),E=Te(Le),Nn=Te(Oe),T=D,G=A,Ce=X,ne=Te(ve);function Te(e){return e&&e.__esModule?e:{default:e}}function Ge(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(Ge=function(o){return o?n:t})(e)}function Mn(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=Ge(t);if(n&&n.has(e))return n.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s)){var c=r?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(o,s,c):o[s]=e[s]}return o.default=e,n&&n.set(e,o),o}function M(e,t,n){return t=Bn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bn(e){var t=En(e,"string");return typeof t=="symbol"?t:String(t)}function En(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const j={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let V=j.mouse,ye=class extends Pe.Component{constructor(){super(...arguments),M(this,"dragging",!1),M(this,"lastX",NaN),M(this,"lastY",NaN),M(this,"touchIdentifier",null),M(this,"mounted",!1),M(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:o}=n;if(this.props.disabled||!(t.target instanceof o.defaultView.Node)||this.props.handle&&!(0,T.matchesSelectorAndParentsTo)(t.target,this.props.handle,n)||this.props.cancel&&(0,T.matchesSelectorAndParentsTo)(t.target,this.props.cancel,n))return;t.type==="touchstart"&&t.preventDefault();const r=(0,T.getTouchIdentifier)(t);this.touchIdentifier=r;const s=(0,G.getControlPosition)(t,r,this);if(s==null)return;const{x:c,y:l}=s,d=(0,G.createCoreData)(this,c,l);(0,ne.default)("DraggableCore: handleDragStart: %j",d),(0,ne.default)("calling",this.props.onStart),!(this.props.onStart(t,d)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,T.addUserSelectStyles)(o),this.dragging=!0,this.lastX=c,this.lastY=l,(0,T.addEvent)(o,V.move,this.handleDrag),(0,T.addEvent)(o,V.stop,this.handleDragStop))}),M(this,"handleDrag",t=>{const n=(0,G.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:o,y:r}=n;if(Array.isArray(this.props.grid)){let l=o-this.lastX,d=r-this.lastY;if([l,d]=(0,G.snapToGrid)(this.props.grid,l,d),!l&&!d)return;o=this.lastX+l,r=this.lastY+d}const s=(0,G.createCoreData)(this,o,r);if((0,ne.default)("DraggableCore: handleDrag: %j",s),this.props.onDrag(t,s)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const d=document.createEvent("MouseEvents");d.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(d)}return}this.lastX=o,this.lastY=r}),M(this,"handleDragStop",t=>{if(!this.dragging)return;const n=(0,G.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:o,y:r}=n;if(Array.isArray(this.props.grid)){let d=o-this.lastX||0,y=r-this.lastY||0;[d,y]=(0,G.snapToGrid)(this.props.grid,d,y),o=this.lastX+d,r=this.lastY+y}const s=(0,G.createCoreData)(this,o,r);if(this.props.onStop(t,s)===!1||this.mounted===!1)return!1;const l=this.findDOMNode();l&&this.props.enableUserSelectHack&&(0,T.removeUserSelectStyles)(l.ownerDocument),(0,ne.default)("DraggableCore: handleDragStop: %j",s),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,l&&((0,ne.default)("DraggableCore: Removing handlers"),(0,T.removeEvent)(l.ownerDocument,V.move,this.handleDrag),(0,T.removeEvent)(l.ownerDocument,V.stop,this.handleDragStop))}),M(this,"onMouseDown",t=>(V=j.mouse,this.handleDragStart(t))),M(this,"onMouseUp",t=>(V=j.mouse,this.handleDragStop(t))),M(this,"onTouchStart",t=>(V=j.touch,this.handleDragStart(t))),M(this,"onTouchEnd",t=>(V=j.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;const t=this.findDOMNode();t&&(0,T.addEvent)(t,j.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const t=this.findDOMNode();if(t){const{ownerDocument:n}=t;(0,T.removeEvent)(n,j.mouse.move,this.handleDrag),(0,T.removeEvent)(n,j.touch.move,this.handleDrag),(0,T.removeEvent)(n,j.mouse.stop,this.handleDragStop),(0,T.removeEvent)(n,j.touch.stop,this.handleDragStop),(0,T.removeEvent)(t,j.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,T.removeUserSelectStyles)(n)}}findDOMNode(){var t,n;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:Nn.default.findDOMNode(this)}render(){return Pe.cloneElement(Pe.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};me.default=ye;M(ye,"displayName","DraggableCore");M(ye,"propTypes",{allowAnyClick:E.default.bool,children:E.default.node.isRequired,disabled:E.default.bool,enableUserSelectHack:E.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:E.default.arrayOf(E.default.number),handle:E.default.string,cancel:E.default.string,nodeRef:E.default.object,onStart:E.default.func,onDrag:E.default.func,onStop:E.default.func,onMouseDown:E.default.func,scale:E.default.number,className:Ce.dontSetMe,style:Ce.dontSetMe,transform:Ce.dontSetMe});M(ye,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),e.default=void 0;var t=g(P),n=S(Le),o=S(Oe),r=S(zt),s=D,c=A,l=X,d=S(me),y=S(ve);function S(f){return f&&f.__esModule?f:{default:f}}function b(f){if(typeof WeakMap!="function")return null;var u=new WeakMap,h=new WeakMap;return(b=function(p){return p?h:u})(f)}function g(f,u){if(!u&&f&&f.__esModule)return f;if(f===null||typeof f!="object"&&typeof f!="function")return{default:f};var h=b(u);if(h&&h.has(f))return h.get(f);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in f)if(m!=="default"&&Object.prototype.hasOwnProperty.call(f,m)){var I=_?Object.getOwnPropertyDescriptor(f,m):null;I&&(I.get||I.set)?Object.defineProperty(p,m,I):p[m]=f[m]}return p.default=f,h&&h.set(f,p),p}function C(){return C=Object.assign?Object.assign.bind():function(f){for(var u=1;u<arguments.length;u++){var h=arguments[u];for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(f[p]=h[p])}return f},C.apply(this,arguments)}function N(f,u,h){return u=K(u),u in f?Object.defineProperty(f,u,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[u]=h,f}function K(f){var u=se(f,"string");return typeof u=="symbol"?u:String(u)}function se(f,u){if(typeof f!="object"||f===null)return f;var h=f[Symbol.toPrimitive];if(h!==void 0){var p=h.call(f,u||"default");if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(f)}class W extends t.Component{static getDerivedStateFromProps(u,h){let{position:p}=u,{prevPropsPosition:_}=h;return p&&(!_||p.x!==_.x||p.y!==_.y)?((0,y.default)("Draggable: getDerivedStateFromProps %j",{position:p,prevPropsPosition:_}),{x:p.x,y:p.y,prevPropsPosition:{...p}}):null}constructor(u){super(u),N(this,"onDragStart",(h,p)=>{if((0,y.default)("Draggable: onDragStart: %j",p),this.props.onStart(h,(0,c.createDraggableData)(this,p))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),N(this,"onDrag",(h,p)=>{if(!this.state.dragging)return!1;(0,y.default)("Draggable: onDrag: %j",p);const _=(0,c.createDraggableData)(this,p),m={x:_.x,y:_.y,slackX:0,slackY:0};if(this.props.bounds){const{x:U,y:Y}=m;m.x+=this.state.slackX,m.y+=this.state.slackY;const[q,J]=(0,c.getBoundPosition)(this,m.x,m.y);m.x=q,m.y=J,m.slackX=this.state.slackX+(U-m.x),m.slackY=this.state.slackY+(Y-m.y),_.x=m.x,_.y=m.y,_.deltaX=m.x-this.state.x,_.deltaY=m.y-this.state.y}if(this.props.onDrag(h,_)===!1)return!1;this.setState(m)}),N(this,"onDragStop",(h,p)=>{if(!this.state.dragging||this.props.onStop(h,(0,c.createDraggableData)(this,p))===!1)return!1;(0,y.default)("Draggable: onDragStop: %j",p);const m={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:U,y:Y}=this.props.position;m.x=U,m.y=Y}this.setState(m)}),this.state={dragging:!1,dragged:!1,x:u.position?u.position.x:u.defaultPosition.x,y:u.position?u.position.y:u.defaultPosition.y,prevPropsPosition:{...u.position},slackX:0,slackY:0,isElementSVG:!1},u.position&&!(u.onDrag||u.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var u,h;return(u=(h=this.props)===null||h===void 0||(h=h.nodeRef)===null||h===void 0?void 0:h.current)!==null&&u!==void 0?u:o.default.findDOMNode(this)}render(){const{axis:u,bounds:h,children:p,defaultPosition:_,defaultClassName:m,defaultClassNameDragging:I,defaultClassNameDragged:U,position:Y,positionOffset:q,scale:J,...Se}=this.props;let ee={},ie=null;const le=!!!Y||this.state.dragging,ce=Y||_,H={x:(0,c.canDragX)(this)&&le?this.state.x:ce.x,y:(0,c.canDragY)(this)&&le?this.state.y:ce.y};this.state.isElementSVG?ie=(0,s.createSVGTransform)(H,q):ee=(0,s.createCSSTransform)(H,q);const te=(0,r.default)(p.props.className||"",m,{[I]:this.state.dragging,[U]:this.state.dragged});return t.createElement(d.default,C({},Se,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(p),{className:te,style:{...p.props.style,...ee},transform:ie}))}}e.default=W,N(W,"displayName","Draggable"),N(W,"propTypes",{...d.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),N(W,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(Fe);const{default:Ve,DraggableCore:On}=Fe;ge.exports=Ve;ge.exports.default=Ve;ge.exports.DraggableCore=On;var Rn=ge.exports;const Fn=ot(Rn),In=(e,t,n,o,r,s,c,l,d,y,S,b)=>[{defaultValue:e("Country"),value:n[t]||"",onChange:g=>l(t,g),items:[{value:"Kenya",content:"Kenya",id:"1"},{value:"Nigeria",content:"Nigeria",id:"2"},{value:"Ghana",content:"Ghana",id:"3"},{value:"Zambia",content:"Zambia",id:"4"},{value:"Uganda",content:"Uganda",id:"5"},{value:"DR Congo",content:"DR Congo",id:"6"},{value:"Cameroon Gabon",content:"Cameroon Gabon",id:"7"},{value:"Benin Burkina Faso Ivory Coast Senegal Mali",content:"Benin Burkina Faso Ivory Coast Senegal Mali",id:"8"},{value:"Angola",content:"Angola",id:"9"},{value:"Morocco",content:"Morocco",id:"10"},{value:"Mozambique",content:"Mozambique",id:"11"},{value:"Tanzania",content:"Tanzania",id:"12"},{value:"Brazil",content:"Brazil",id:"13"},{value:"India",content:"India",id:"14"},{value:"Peru",content:"Peru",id:"15"},{value:"Argentina",content:"Argentina",id:"16"},{value:"Mexico",content:"Mexico",id:"17"},{value:"Colombia",content:"Colombia",id:"18"},{value:"Chile",content:"Chile",id:"19"},{value:"Malaysia",content:"Malaysia",id:"20"},{value:"Indonesia",content:"Indonesia",id:"21"},{value:"Thailand",content:"Thailand",id:"22"},{value:"Uzbekistan",content:"Uzbekistan",id:"23"},{value:"Philippines",content:"Philippines",id:"24"},{value:"Bangladesh",content:"Bangladesh",id:"25"}]},{defaultValue:e("Language"),value:o[t]||"",onChange:g=>d(t,g),items:[{value:"English",content:"English",id:"1"},{value:"Русский",content:"Русский",id:"2"},{value:"Française",content:"Française",id:"3"},{value:"Español",content:"Español",id:"4"},{value:"Português",content:"Português",id:"5"}]},{defaultValue:e("Currency"),value:r[t]||"",onChange:g=>y(t,g),items:[{value:"KES",content:"KES",id:"1"},{value:"NGN",content:"NGN",id:"2"},{value:"GHS",content:"GHS",id:"3"},{value:"ZMW",content:"ZMW",id:"4"},{value:"UGX",content:"UGX",id:"5"},{value:"CDF",content:"CDF",id:"6"},{value:"XAF",content:"XAF",id:"7"},{value:"XOF",content:"XOF",id:"8"},{value:"AOA",content:"AOA",id:"9"},{value:"MAD",content:"MAD",id:"10"},{value:"MZN",content:"MZN",id:"11"},{value:"TZS",content:"TZS",id:"12"},{value:"BRL",content:"BRL",id:"13"},{value:"INR",content:"INR",id:"14"},{value:"PEN",content:"PEN",id:"15"},{value:"ARS",content:"ARS",id:"16"},{value:"MXN",content:"MXN",id:"17"},{value:"COP",content:"COP",id:"18"},{value:"CLP",content:"CLP",id:"19"},{value:"MYR",content:"MYR",id:"20"},{value:"IDR",content:"IDR",id:"21"},{value:"THB",content:"THB",id:"22"},{value:"UZS",content:"UZS",id:"23"},{value:"PHP",content:"PHP",id:"24"},{value:"BDT",content:"BDT",id:"25"}]},{defaultValue:e("Banner format"),value:s[t]||"",onChange:g=>S(t,g),items:[{value:"300x300",content:"300x300",id:"1"},{value:"600x600",content:"600x600",id:"2"},{value:"900x900",content:"900x900",id:"3"}]},{defaultValue:e("Banner theme"),value:c[t]||"",onChange:g=>b(t,g),items:[{value:"footbal",content:"footbal",id:"1"}]}];function Un({t:e,index:t,selectedCountries:n,selectedLanguages:o,selectedCurrencies:r,selectedBannerFormats:s,selectedBannerThemes:c,handleChangeCountry:l,handleChangeLanguage:d,handleChangeCurrency:y,handleChangeBannerFormat:S,handleChangeBannerTheme:b}){const g=In(e,t,n,o,r,s,c,l,d,y,S,b);return v.jsx("ul",{className:`${R.topbar}`,children:g.map((C,N)=>v.jsx("li",{className:R.defaultSelect,children:v.jsx(ut,{...C})},N))})}const jn=(e,t,n,o,r,s,c)=>[{type:"text",placeholder:"Label",value:t[e]||"",onChange:l=>r(e,l)},{type:"number",placeholder:"Text Size",value:n[e]||"",onChange:l=>s(e,l)},{type:"color",placeholder:"Text Color",value:o[e]||"",onChange:l=>c(e,l)}];function Ln({index:e,texts:t,textSizes:n,textColors:o,handleTextChange:r,handleSizeChange:s,handleColorChange:c}){const l=jn(e,t,n,o,r,s,c);return v.jsx("div",{children:l.map((d,y)=>v.jsx("input",{className:R.redactorIn,type:d.type,placeholder:d.placeholder,value:d.value,onChange:d.onChange},y))})}const kn=({images:e})=>{const{t}=it(),n=Re(at),[o,r]=P.useState(),[s,c]=P.useState(!1),[l,d]=P.useState([]),[y,S]=P.useState([]),[b,g]=P.useState([]),[C,N]=P.useState([,]),[K,se]=P.useState([,]),[W,f]=P.useState([]),[u,h]=P.useState([]),[p,_]=P.useState([]),[m,I]=P.useState([]),U=P.useRef([]);P.useEffect(()=>{e&&(f(e.map(a=>({x:a.left||0,y:a.top||0}))),h(e.map(a=>a.name||"Your Text")),_(e.map(a=>a.size||"30")),I(e.map(a=>a.color_text||"#ffffff")),d(e.map(a=>a.country||t("Country"))),S(e.map(a=>a.language||t("Language"))),g(e.map(a=>a.value||t("Currency"))),N(e.map(a=>a.format||t("Banner format"))),se(e.map(a=>a.topic||t("Banner theme"))),U.current=e.map(()=>rt.createRef()))},[e]);const Y=oe({mutationFn:a=>gt(a.picture_id,a.country,a.language,a.value,a.format,a.topic,a.color,a.left,a.right,a.top,a.bottom,a.size),onSuccess:()=>{k.invalidateQueries({queryKey:["img"]})},onError:a=>{be.error(a.message)}},k),q=oe({mutationFn:a=>mt(a.full_picture_id,a.country,a.language,a.value,a.format,a.topic,a.color,a.left,a.right,a.top,a.bottom,a.size),onSuccess:()=>{k.invalidateQueries({queryKey:["img"]})}},k),J=oe({mutationFn:a=>ct(a.token,a.full_picture_id),onSuccess:a=>{r(a)},onError:a=>{be.error(a.message)}},k),Se=a=>{J.mutate({token:n,full_picture_id:a})},ee=oe({mutationFn:a=>vt(a.full_picture_id),onSuccess:a=>{k.invalidateQueries({queryKey:["img"]}),be.success(a.data)}},k),ie=a=>{ee.mutate({full_picture_id:a})},Ne=(a,i,B)=>{const x=[...W];x[a]={x:B.x,y:B.y},f(x)},le=(a,i)=>{const B=W[i],x=U.current[i].current;if(B&&x){const L=x.offsetWidth,ue=x.offsetHeight,{x:de,y:fe}=B;a&&Y.mutate({picture_id:a,country:l[i],language:y[i],value:b[i],format:C[i],topic:K[i],color:m[i],left:de.toString(),right:(de+L).toString(),top:fe.toString(),bottom:(fe+ue).toString(),size:p[i]})}},ce=(a,i)=>{const B=W[i],x=U.current[i].current;if(B&&x){const{x:L,y:ue}=B,de=x.offsetWidth,fe=x.offsetHeight;a&&q.mutate({full_picture_id:a,country:l[i],language:y[i],value:b[i],format:C[i],topic:K[i],color:m[i],left:L.toString(),right:(L+de).toString(),top:ue.toString(),bottom:(ue+fe).toString(),size:p[i]})}},H=(a,i,B,x)=>{const L=[...x];L[a]=i,B(L)},te=(a,i,B,x)=>{const L=[...x];L[a]=i.target.value,B(L)},qe=(a,i)=>{te(a,i,h,u)},ze=(a,i)=>{te(a,i,_,p)},Ke=(a,i)=>{te(a,i,I,m)},Ze=(a,i)=>{H(a,i,d,l)},Qe=(a,i)=>{H(a,i,S,y)},Je=(a,i)=>{H(a,i,g,b)},et=(a,i)=>{H(a,i,N,C)},tt=(a,i)=>{H(a,i,se,K)};return v.jsxs("div",{className:R.mainBox,children:[v.jsx("img",{className:R.redactorImg,src:o,alt:""}),e&&e.map((a,i)=>v.jsxs("div",{className:R.redactorBox,children:[v.jsxs("div",{className:R.draggableImgBox,children:[v.jsx(Fn,{position:W[i],onDrag:(B,x)=>Ne(i,B,x),bounds:"parent",nodeRef:U.current[i],children:v.jsx("div",{ref:U.current[i],className:R.draggableBox,style:{fontSize:`${p[i]}px`,color:m[i]},children:u[i]})}),v.jsx("img",{className:R.redactorImg,src:a.url,alt:`img-${i}`})]}),v.jsx(Ln,{index:i,texts:u,textSizes:p,textColors:m,handleTextChange:qe,handleSizeChange:ze,handleColorChange:Ke}),v.jsx(Un,{t,index:i,selectedCountries:l,selectedLanguages:y,selectedCurrencies:b,selectedBannerFormats:C,selectedBannerThemes:K,handleChangeCountry:Ze,handleChangeLanguage:Qe,handleChangeCurrency:Je,handleChangeBannerFormat:et,handleChangeBannerTheme:tt}),a.picture_id?v.jsx(Z,{isLoading:Y.isPending,isDisabled:s,className:R.adminRedactorButton,onClick:()=>le(a.picture_id,i),children:"Отправить"}):v.jsxs(v.Fragment,{children:[v.jsx(Z,{isLoading:q.isPending,isDisabled:s,className:R.adminRedactorButton,onClick:()=>ce(a.full_picture_id,i),children:"Изменить"}),v.jsx(Z,{isLoading:ee.isPending,className:R.publish,onClick:()=>ie(a.full_picture_id),children:"Опубликовать"}),v.jsx(Z,{isLoading:J.isPending,className:R.publish,onClick:()=>Se(a.full_picture_id),children:"Demo"})]})]},i))]})};function zn(){const e=Re(st),[t,n]=P.useState(),o=lt({queryKey:["img"],queryFn:()=>ht(),enabled:!!(e!=null&&e.is_admin),retry:1},k);return P.useEffect(()=>{o.data&&n(o.data)},[o.data]),v.jsx(v.Fragment,{children:v.jsxs("div",{className:ft.adminPanelBlock,children:[v.jsx(Et,{}),v.jsx(kn,{images:t})]})})}export{zn as default};
