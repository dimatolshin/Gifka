import{r as l,j as t,L as p,a as x,u as f,g as V,i as B,d as L,O as A}from"./index-5e81b91c.js";import{L as N}from"./LoadImgServ-90e91a5f.js";import{f as S,l as C,a as E}from"./dataImg-ad0e902f.js";import{u as F}from"./useQuery-731aa69e.js";import{u as R,a as U,q as j}from"./queryClient-4e3f4a74.js";import{g as q}from"./getAdminImg-09967c00.js";import{L as $}from"./ListFilter-770b5bdd.js";import{B as _}from"./Button-1ab70214.js";import"./Modal.module-7cebd6cd.js";import"./ListBox-a88bdaf2.js";const w="_adminPanelBlock_orxl9_1",O="_adminPanelBlockRight_orxl9_8",T="_adminPanelBlockUpper_orxl9_14",m={adminPanelBlock:w,adminPanelBlockRight:O,adminPanelBlockUpper:T},D="_staticImgBlock_17rmn_1",K="_pictureIdList_17rmn_6",M="_link_17rmn_11",u={staticImgBlock:D,pictureIdList:K,link:M};function Q({images:n}){const[i,c]=l.useState([]),[a,r]=l.useState([]);return l.useEffect(()=>{n&&(c(n.filter(s=>s.picture_id)),r(n.filter(s=>s.full_picture_id)))},[n]),t.jsxs("div",{className:u.staticImgBlock,children:[t.jsxs("div",{children:[t.jsx("h2",{children:"Новые элементы"}),t.jsx("div",{className:u.pictureIdList,children:i.map(s=>t.jsx("div",{children:t.jsx(p,{className:u.link,to:`new/${s.picture_id}`,children:s.picture_id})},s.picture_id))})]}),t.jsxs("div",{children:[t.jsx("h2",{children:"Старые элементы"}),a.map(s=>t.jsx("div",{children:t.jsxs(p,{className:u.link,to:`old/${s.full_picture_id}`,children:[s.full_picture_id," ",s.name]})},s.full_picture_id))]})]})}const z="_filterBtns_v0c02_1",h={filterBtns:z};function G(){const n={country:"",language:"",currency:"",banner_format:"",banner_theme:""},i=x(),c=f(V),{t:a}=R(),[r,s]=l.useState([{id:1,selectedValues:n}]),y=(e,o,P)=>{s(r.map(d=>d.id===e?{...d,selectedValues:{...d.selectedValues,[o]:P}}:d))},g=U({mutationFn:e=>S(e.token,e.country,e.language,e.value,e.format,e.topic),onSuccess:e=>{i(B.adminImgAdd(e))}},j),I=()=>{r.forEach(e=>{g.mutate({token:c,country:e.selectedValues.country===a("Country")?"":e.selectedValues.country,language:e.selectedValues.language===a("Language")?"":e.selectedValues.language,value:e.selectedValues.currency===a("Currency")?"":e.selectedValues.currency,format:e.selectedValues.banner_format===a("Banner_format")?"":e.selectedValues.banner_format,topic:e.selectedValues.banner_theme===a("Banner_theme")?"":e.selectedValues.banner_theme})})},k=()=>{g.mutate({token:c,country:"",language:"",value:"",format:"",topic:""})},v=e=>s(r.filter(o=>o.id!==e));return t.jsxs("div",{children:[r.map((e,o)=>t.jsx($,{index:o,block:e,listBoxItems:C,handleListBoxChange:y,removeBlock:v,t:a},e.id)),t.jsx(_,{className:h.filterBtns,onClick:I,children:"Фильтровать"}),t.jsx(_,{className:h.filterBtns,onClick:k,children:"Очистить фильтр"})]})}function ne(){const n=f(L),i=f(q),c=x(),[a,r]=l.useState();l.useEffect(()=>{Array.isArray(i)&&i&&r(i)},[i]);const s=F({queryKey:["img"],queryFn:()=>E(),enabled:!!(n!=null&&n.is_admin),retry:1},j);return l.useEffect(()=>{s.data&&c(B.adminImgAdd(s.data))},[s.data]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:m.adminPanelBlock,children:[t.jsx(N,{}),t.jsxs("div",{className:m.adminPanelBlockRight,children:[t.jsxs("div",{className:m.adminPanelBlockUpper,children:[t.jsx(G,{}),t.jsx(Q,{images:a})]}),t.jsx(A,{})]})]})})}export{ne as default};
