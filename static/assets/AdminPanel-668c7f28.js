import{r as x,j as f,i as Ve,k as Ee,h as qe,u as Be,g as He,R as Ge,d as ze}from"./index-03d3b032.js";import{b as te,a as Z,q as Y,u as Ke}from"./queryClient-97deb47d.js";import{B as ee}from"./Button-bf52856a.js";import"./Modal.module-7cebd6cd.js";import{u as Qe}from"./useQuery-9f273391.js";import{L as Q}from"./ListBox-b81e0165.js";import{_ as ye}from"./index-6d616f72.js";import{a as Je}from"./staticGif-cd686322.js";const Ze="_adminPanelBlock_e9yg1_1",et={adminPanelBlock:Ze},ne="https://bwcreatorhub.com";function tt(e){return te.post(`${ne}/api/load_picture/`,e).then(()=>{})}function nt(){return te.get(`${ne}/api/all_picture/`).then(e=>e.data).catch(e=>{const t=Object.keys(e.response.data).map(n=>`${e.response.data[n]}`).join(", ");throw new Error(t)})}const rt=(e,t,n,r,a,l,d,m,h,S,y)=>te.post(`${ne}/api/createFullPicture/`,{picture_id:e,country:t,language:n,value:r,format:a,topic:l,color:d,left:m,right:h,top:S,bottom:y}).then(_=>_.data).catch(_=>{const b=Object.keys(_.response.data).map(O=>`${_.response.data[O]}`).join(", ");throw new Error(b)}),ot=(e,t,n,r,a,l,d,m,h,S,y)=>te.post(`${ne}/api/createFullPicture/`,{full_picture_id:e,country:t,language:n,value:r,format:a,topic:l,color:d,left:m,right:h,top:S,bottom:y}).then(_=>_.data).catch(_=>{const b=Object.keys(_.response.data).map(O=>`${_.response.data[O]}`).join(", ");throw new Error(b)}),at=e=>te.post(`${ne}/api/get_is_publish/`,{full_picture_id:e}).then(t=>t.data).catch(t=>{const n=Object.keys(t.response.data).map(r=>`${t.response.data[r]}`).join(", ");throw new Error(n)});var P=[];for(var ve=0;ve<256;++ve)P.push((ve+256).toString(16).slice(1));function st(e,t=0){return(P[e[t+0]]+P[e[t+1]]+P[e[t+2]]+P[e[t+3]]+"-"+P[e[t+4]]+P[e[t+5]]+"-"+P[e[t+6]]+P[e[t+7]]+"-"+P[e[t+8]]+P[e[t+9]]+"-"+P[e[t+10]]+P[e[t+11]]+P[e[t+12]]+P[e[t+13]]+P[e[t+14]]+P[e[t+15]]).toLowerCase()}var ue,it=new Uint8Array(16);function lt(){if(!ue&&(ue=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ue))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ue(it)}var ct=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Pe={randomUUID:ct};function ut(e,t,n){if(Pe.randomUUID&&!t&&!e)return Pe.randomUUID();e=e||{};var r=e.random||(e.rng||lt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return st(r)}const dt="_fileBlock_16uh2_1",ft="_inputBlock_16uh2_8",pt="_hiddenInput_16uh2_14",ht="_customLabel_16uh2_18",gt="_loadButton_16uh2_30",mt="_deleteButton_16uh2_37",yt="_selectedFile_16uh2_43",vt="_selectedFilesList_16uh2_47",k={fileBlock:dt,inputBlock:ft,hiddenInput:pt,customLabel:ht,loadButton:gt,deleteButton:mt,selectedFile:yt,selectedFilesList:vt};function St(){const e=x.useRef(null),[t,n]=x.useState([]),[r,a]=x.useState(null),l=y=>{const _=Array.from(y.target.files).map(b=>({id:ut(),file:b}));n(b=>[...b,..._]),a(_[_.length-1].file.name)},d=Z({mutationFn:y=>tt(y.formData),onSuccess:()=>{a(null),n([]),Y.invalidateQueries({queryKey:["img"]})}},Y),m=async()=>{if(t.length===0){alert("Файл не добавлен");return}const y=new FormData;t.forEach(({file:_})=>{y.append("photos",_)}),d.mutate({formData:y})},h=y=>{n(_=>{const b=_.filter(O=>O.id!==y);return b.length>0?a(b[b.length-1].file.name):a(null),b})},S=()=>{e.current.click()};return f.jsxs("div",{className:k.fileBlock,children:[f.jsxs("div",{className:k.inputBlock,children:[f.jsx("input",{type:"file",multiple:!0,onChange:l,className:k.hiddenInput,ref:e,accept:"image/*,.png,.jpg,.gif,.web,.jpeg,.svg"}),f.jsx("button",{onClick:S,className:k.customLabel,children:"Выбрать файлы"}),f.jsx(ee,{className:k.loadButton,onClick:m,children:"Загрузить"})]}),r&&f.jsxs("span",{className:k.fileName,children:["Последний загруженный файл: ",r]}),f.jsx("ul",{className:k.selectedFilesList,children:t.map(({id:y,file:_})=>f.jsxs("li",{children:[f.jsxs("p",{className:k.selectedFile,children:["Название файла: ",_.name]}),f.jsx(ee,{className:k.deleteButton,onClick:()=>h(y),children:"Удалить"})]},y))})]})}const _t="_mainBox_jgpv3_1",Dt="_redactorBox_jgpv3_6",bt="_draggableBox_jgpv3_12",wt="_redactorImg_jgpv3_19",xt="_redactorInput_jgpv3_23",Ct="_topbar_jgpv3_27",Pt="_topBtn_jgpv3_35",Tt="_defaultSelect_jgpv3_41",Nt="_lastDefaultSelect_jgpv3_48",Et="_adminRedactorButton_jgpv3_52",Bt="_draggableImgBox_jgpv3_59",C={mainBox:_t,redactorBox:Dt,draggableBox:bt,redactorImg:wt,redactorInput:xt,topbar:Ct,topBtn:Pt,defaultSelect:Tt,lastDefaultSelect:Nt,adminRedactorButton:Et,draggableImgBox:Bt};var fe={exports:{}},Me={},Oe={exports:{}},Mt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ot=Mt,jt=Ot;function je(){}function Fe(){}Fe.resetWarningCache=je;var Ft=function(){function e(r,a,l,d,m,h){if(h!==jt){var S=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw S.name="Invariant Violation",S}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Fe,resetWarningCache:je};return n.PropTypes=n,n};Oe.exports=Ft();var Ie=Oe.exports;function Re(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Re(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function Te(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=Re(e))&&(r&&(r+=" "),r+=t);return r}const It=Object.freeze(Object.defineProperty({__proto__:null,clsx:Te,default:Te},Symbol.toStringTag,{value:"Module"})),Rt=Ve(It);var D={},U={};Object.defineProperty(U,"__esModule",{value:!0});U.dontSetMe=$t;U.findInArray=Ut;U.int=Yt;U.isFunction=Lt;U.isNum=kt;function Ut(e,t){for(let n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]}function Lt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function kt(e){return typeof e=="number"&&!isNaN(e)}function Yt(e){return parseInt(e,10)}function $t(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))}var q={};Object.defineProperty(q,"__esModule",{value:!0});q.browserPrefixToKey=Le;q.browserPrefixToStyle=Xt;q.default=void 0;q.getPrefix=Ue;const Se=["Moz","Webkit","O","ms"];function Ue(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!n||t in n)return"";for(let r=0;r<Se.length;r++)if(Le(t,Se[r])in n)return Se[r];return""}function Le(e,t){return t?"".concat(t).concat(Wt(e)):e}function Xt(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function Wt(e){let t="",n=!0;for(let r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):e[r]==="-"?n=!0:t+=e[r];return t}q.default=Ue();Object.defineProperty(D,"__esModule",{value:!0});D.addClassName=$e;D.addEvent=qt;D.addUserSelectStyles=rn;D.createCSSTransform=Zt;D.createSVGTransform=en;D.getTouch=tn;D.getTouchIdentifier=nn;D.getTranslation=be;D.innerHeight=Kt;D.innerWidth=Qt;D.matchesSelector=Ye;D.matchesSelectorAndParentsTo=Vt;D.offsetXYFromParent=Jt;D.outerHeight=Gt;D.outerWidth=zt;D.removeClassName=Xe;D.removeEvent=Ht;D.removeUserSelectStyles=on;var M=U,Ne=At(q);function ke(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(ke=function(r){return r?n:t})(e)}function At(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=ke(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var d=a?Object.getOwnPropertyDescriptor(e,l):null;d&&(d.get||d.set)?Object.defineProperty(r,l,d):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}let de="";function Ye(e,t){return de||(de=(0,M.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,M.isFunction)(e[n])})),(0,M.isFunction)(e[de])?e[de](t):!1}function Vt(e,t,n){let r=e;do{if(Ye(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function qt(e,t,n,r){if(!e)return;const a={capture:!0,...r};e.addEventListener?e.addEventListener(t,n,a):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function Ht(e,t,n,r){if(!e)return;const a={capture:!0,...r};e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}function Gt(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,M.int)(n.borderTopWidth),t+=(0,M.int)(n.borderBottomWidth),t}function zt(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,M.int)(n.borderLeftWidth),t+=(0,M.int)(n.borderRightWidth),t}function Kt(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,M.int)(n.paddingTop),t-=(0,M.int)(n.paddingBottom),t}function Qt(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,M.int)(n.paddingLeft),t-=(0,M.int)(n.paddingRight),t}function Jt(e,t,n){const a=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),l=(e.clientX+t.scrollLeft-a.left)/n,d=(e.clientY+t.scrollTop-a.top)/n;return{x:l,y:d}}function Zt(e,t){const n=be(e,t,"px");return{[(0,Ne.browserPrefixToKey)("transform",Ne.default)]:n}}function en(e,t){return be(e,t,"")}function be(e,t,n){let{x:r,y:a}=e,l="translate(".concat(r).concat(n,",").concat(a).concat(n,")");if(t){const d="".concat(typeof t.x=="string"?t.x:t.x+n),m="".concat(typeof t.y=="string"?t.y:t.y+n);l="translate(".concat(d,", ").concat(m,")")+l}return l}function tn(e,t){return e.targetTouches&&(0,M.findInArray)(e.targetTouches,n=>t===n.identifier)||e.changedTouches&&(0,M.findInArray)(e.changedTouches,n=>t===n.identifier)}function nn(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function rn(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&$e(e.body,"react-draggable-transparent-selection")}function on(e){if(e)try{if(e.body&&Xe(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch{}}function $e(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function Xe(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}var L={};Object.defineProperty(L,"__esModule",{value:!0});L.canDragX=ln;L.canDragY=cn;L.createCoreData=dn;L.createDraggableData=fn;L.getBoundPosition=an;L.getControlPosition=un;L.snapToGrid=sn;var B=U,G=D;function an(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:r}=e.props;r=typeof r=="string"?r:pn(r);const a=we(e);if(typeof r=="string"){const{ownerDocument:l}=a,d=l.defaultView;let m;if(r==="parent"?m=a.parentNode:m=l.querySelector(r),!(m instanceof d.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const h=m,S=d.getComputedStyle(a),y=d.getComputedStyle(h);r={left:-a.offsetLeft+(0,B.int)(y.paddingLeft)+(0,B.int)(S.marginLeft),top:-a.offsetTop+(0,B.int)(y.paddingTop)+(0,B.int)(S.marginTop),right:(0,G.innerWidth)(h)-(0,G.outerWidth)(a)-a.offsetLeft+(0,B.int)(y.paddingRight)-(0,B.int)(S.marginRight),bottom:(0,G.innerHeight)(h)-(0,G.outerHeight)(a)-a.offsetTop+(0,B.int)(y.paddingBottom)-(0,B.int)(S.marginBottom)}}return(0,B.isNum)(r.right)&&(t=Math.min(t,r.right)),(0,B.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,B.isNum)(r.left)&&(t=Math.max(t,r.left)),(0,B.isNum)(r.top)&&(n=Math.max(n,r.top)),[t,n]}function sn(e,t,n){const r=Math.round(t/e[0])*e[0],a=Math.round(n/e[1])*e[1];return[r,a]}function ln(e){return e.props.axis==="both"||e.props.axis==="x"}function cn(e){return e.props.axis==="both"||e.props.axis==="y"}function un(e,t,n){const r=typeof t=="number"?(0,G.getTouch)(e,t):null;if(typeof t=="number"&&!r)return null;const a=we(n),l=n.props.offsetParent||a.offsetParent||a.ownerDocument.body;return(0,G.offsetXYFromParent)(r||e,l,n.props.scale)}function dn(e,t,n){const r=!(0,B.isNum)(e.lastX),a=we(e);return r?{node:a,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:a,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}}function fn(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}}function pn(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function we(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}var pe={},he={};Object.defineProperty(he,"__esModule",{value:!0});he.default=hn;function hn(){}Object.defineProperty(pe,"__esModule",{value:!0});pe.default=void 0;var _e=mn(x),E=xe(Ie),gn=xe(Ee),T=D,X=L,De=U,J=xe(he);function xe(e){return e&&e.__esModule?e:{default:e}}function We(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(We=function(r){return r?n:t})(e)}function mn(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var n=We(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(l!=="default"&&Object.prototype.hasOwnProperty.call(e,l)){var d=a?Object.getOwnPropertyDescriptor(e,l):null;d&&(d.get||d.set)?Object.defineProperty(r,l,d):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}function N(e,t,n){return t=yn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yn(e){var t=vn(e,"string");return typeof t=="symbol"?t:String(t)}function vn(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const j={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let W=j.mouse,ge=class extends _e.Component{constructor(){super(...arguments),N(this,"dragging",!1),N(this,"lastX",NaN),N(this,"lastY",NaN),N(this,"touchIdentifier",null),N(this,"mounted",!1),N(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(t.target instanceof r.defaultView.Node)||this.props.handle&&!(0,T.matchesSelectorAndParentsTo)(t.target,this.props.handle,n)||this.props.cancel&&(0,T.matchesSelectorAndParentsTo)(t.target,this.props.cancel,n))return;t.type==="touchstart"&&t.preventDefault();const a=(0,T.getTouchIdentifier)(t);this.touchIdentifier=a;const l=(0,X.getControlPosition)(t,a,this);if(l==null)return;const{x:d,y:m}=l,h=(0,X.createCoreData)(this,d,m);(0,J.default)("DraggableCore: handleDragStart: %j",h),(0,J.default)("calling",this.props.onStart),!(this.props.onStart(t,h)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,T.addUserSelectStyles)(r),this.dragging=!0,this.lastX=d,this.lastY=m,(0,T.addEvent)(r,W.move,this.handleDrag),(0,T.addEvent)(r,W.stop,this.handleDragStop))}),N(this,"handleDrag",t=>{const n=(0,X.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:r,y:a}=n;if(Array.isArray(this.props.grid)){let m=r-this.lastX,h=a-this.lastY;if([m,h]=(0,X.snapToGrid)(this.props.grid,m,h),!m&&!h)return;r=this.lastX+m,a=this.lastY+h}const l=(0,X.createCoreData)(this,r,a);if((0,J.default)("DraggableCore: handleDrag: %j",l),this.props.onDrag(t,l)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const h=document.createEvent("MouseEvents");h.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(h)}return}this.lastX=r,this.lastY=a}),N(this,"handleDragStop",t=>{if(!this.dragging)return;const n=(0,X.getControlPosition)(t,this.touchIdentifier,this);if(n==null)return;let{x:r,y:a}=n;if(Array.isArray(this.props.grid)){let h=r-this.lastX||0,S=a-this.lastY||0;[h,S]=(0,X.snapToGrid)(this.props.grid,h,S),r=this.lastX+h,a=this.lastY+S}const l=(0,X.createCoreData)(this,r,a);if(this.props.onStop(t,l)===!1||this.mounted===!1)return!1;const m=this.findDOMNode();m&&this.props.enableUserSelectHack&&(0,T.removeUserSelectStyles)(m.ownerDocument),(0,J.default)("DraggableCore: handleDragStop: %j",l),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,m&&((0,J.default)("DraggableCore: Removing handlers"),(0,T.removeEvent)(m.ownerDocument,W.move,this.handleDrag),(0,T.removeEvent)(m.ownerDocument,W.stop,this.handleDragStop))}),N(this,"onMouseDown",t=>(W=j.mouse,this.handleDragStart(t))),N(this,"onMouseUp",t=>(W=j.mouse,this.handleDragStop(t))),N(this,"onTouchStart",t=>(W=j.touch,this.handleDragStart(t))),N(this,"onTouchEnd",t=>(W=j.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;const t=this.findDOMNode();t&&(0,T.addEvent)(t,j.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const t=this.findDOMNode();if(t){const{ownerDocument:n}=t;(0,T.removeEvent)(n,j.mouse.move,this.handleDrag),(0,T.removeEvent)(n,j.touch.move,this.handleDrag),(0,T.removeEvent)(n,j.mouse.stop,this.handleDragStop),(0,T.removeEvent)(n,j.touch.stop,this.handleDragStop),(0,T.removeEvent)(t,j.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,T.removeUserSelectStyles)(n)}}findDOMNode(){var t,n;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:gn.default.findDOMNode(this)}render(){return _e.cloneElement(_e.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};pe.default=ge;N(ge,"displayName","DraggableCore");N(ge,"propTypes",{allowAnyClick:E.default.bool,children:E.default.node.isRequired,disabled:E.default.bool,enableUserSelectHack:E.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:E.default.arrayOf(E.default.number),handle:E.default.string,cancel:E.default.string,nodeRef:E.default.object,onStart:E.default.func,onDrag:E.default.func,onStop:E.default.func,onMouseDown:E.default.func,scale:E.default.number,className:De.dontSetMe,style:De.dontSetMe,transform:De.dontSetMe});N(ge,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return h.default}}),e.default=void 0;var t=b(x),n=y(Ie),r=y(Ee),a=y(Rt),l=D,d=L,m=U,h=y(pe),S=y(he);function y(c){return c&&c.__esModule?c:{default:c}}function _(c){if(typeof WeakMap!="function")return null;var u=new WeakMap,g=new WeakMap;return(_=function(p){return p?g:u})(c)}function b(c,u){if(!u&&c&&c.__esModule)return c;if(c===null||typeof c!="object"&&typeof c!="function")return{default:c};var g=_(u);if(g&&g.has(c))return g.get(c);var p={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in c)if(v!=="default"&&Object.prototype.hasOwnProperty.call(c,v)){var I=w?Object.getOwnPropertyDescriptor(c,v):null;I&&(I.get||I.set)?Object.defineProperty(p,v,I):p[v]=c[v]}return p.default=c,g&&g.set(c,p),p}function O(){return O=Object.assign?Object.assign.bind():function(c){for(var u=1;u<arguments.length;u++){var g=arguments[u];for(var p in g)Object.prototype.hasOwnProperty.call(g,p)&&(c[p]=g[p])}return c},O.apply(this,arguments)}function F(c,u,g){return u=re(u),u in c?Object.defineProperty(c,u,{value:g,enumerable:!0,configurable:!0,writable:!0}):c[u]=g,c}function re(c){var u=z(c,"string");return typeof u=="symbol"?u:String(u)}function z(c,u){if(typeof c!="object"||c===null)return c;var g=c[Symbol.toPrimitive];if(g!==void 0){var p=g.call(c,u||"default");if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(c)}class A extends t.Component{static getDerivedStateFromProps(u,g){let{position:p}=u,{prevPropsPosition:w}=g;return p&&(!w||p.x!==w.x||p.y!==w.y)?((0,S.default)("Draggable: getDerivedStateFromProps %j",{position:p,prevPropsPosition:w}),{x:p.x,y:p.y,prevPropsPosition:{...p}}):null}constructor(u){super(u),F(this,"onDragStart",(g,p)=>{if((0,S.default)("Draggable: onDragStart: %j",p),this.props.onStart(g,(0,d.createDraggableData)(this,p))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),F(this,"onDrag",(g,p)=>{if(!this.state.dragging)return!1;(0,S.default)("Draggable: onDrag: %j",p);const w=(0,d.createDraggableData)(this,p),v={x:w.x,y:w.y,slackX:0,slackY:0};if(this.props.bounds){const{x:V,y:$}=v;v.x+=this.state.slackX,v.y+=this.state.slackY;const[H,oe]=(0,d.getBoundPosition)(this,v.x,v.y);v.x=H,v.y=oe,v.slackX=this.state.slackX+(V-v.x),v.slackY=this.state.slackY+($-v.y),w.x=v.x,w.y=v.y,w.deltaX=v.x-this.state.x,w.deltaY=v.y-this.state.y}if(this.props.onDrag(g,w)===!1)return!1;this.setState(v)}),F(this,"onDragStop",(g,p)=>{if(!this.state.dragging||this.props.onStop(g,(0,d.createDraggableData)(this,p))===!1)return!1;(0,S.default)("Draggable: onDragStop: %j",p);const v={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:V,y:$}=this.props.position;v.x=V,v.y=$}this.setState(v)}),this.state={dragging:!1,dragged:!1,x:u.position?u.position.x:u.defaultPosition.x,y:u.position?u.position.y:u.defaultPosition.y,prevPropsPosition:{...u.position},slackX:0,slackY:0,isElementSVG:!1},u.position&&!(u.onDrag||u.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var u,g;return(u=(g=this.props)===null||g===void 0||(g=g.nodeRef)===null||g===void 0?void 0:g.current)!==null&&u!==void 0?u:r.default.findDOMNode(this)}render(){const{axis:u,bounds:g,children:p,defaultPosition:w,defaultClassName:v,defaultClassNameDragging:I,defaultClassNameDragged:V,position:$,positionOffset:H,scale:oe,...me}=this.props;let ae={},se=null;const ie=!!!$||this.state.dragging,le=$||w,ce={x:(0,d.canDragX)(this)&&ie?this.state.x:le.x,y:(0,d.canDragY)(this)&&ie?this.state.y:le.y};this.state.isElementSVG?se=(0,l.createSVGTransform)(ce,H):ae=(0,l.createCSSTransform)(ce,H);const o=(0,a.default)(p.props.className||"",v,{[I]:this.state.dragging,[V]:this.state.dragged});return t.createElement(h.default,O({},me,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(p),{className:o,style:{...p.props.style,...ae},transform:se}))}}e.default=A,F(A,"displayName","Draggable"),F(A,"propTypes",{...h.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:m.dontSetMe,style:m.dontSetMe,transform:m.dontSetMe}),F(A,"defaultProps",{...h.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(Me);const{default:Ae,DraggableCore:Sn}=Me;fe.exports=Ae;fe.exports.default=Ae;fe.exports.DraggableCore=Sn;var _n=fe.exports;const Dn=qe(_n),bn=({images:e})=>{const{t}=Ke();Be(He);const[n,r]=x.useState([]),[a,l]=x.useState([]),[d,m]=x.useState([]),[h,S]=x.useState([]),[y,_]=x.useState([]),[b,O]=x.useState([]),[F,re]=x.useState([]),[z,A]=x.useState([]),[c,u]=x.useState([]),g=x.useRef([]);x.useEffect(()=>{e&&(O(e.map(o=>({x:o.left||0,y:o.top||0}))),re(e.map(o=>o.name||"Your Text")),A(e.map(()=>30)),u(e.map(o=>o.color_text||"#ffffff")),r(e.map(o=>o.country||t("Country"))),l(e.map(o=>o.language||t("Language"))),m(e.map(o=>o.value||t("Currency"))),S(e.map(o=>o.format||t("Banner format"))),_(e.map(o=>o.topic||t("Banner theme"))),g.current=e.map(()=>Ge.createRef()))},[e]);const p=Z({mutationFn:o=>rt(o.picture_id,o.country,o.language,o.value,o.format,o.topic,o.color,o.left,o.right,o.top,o.bottom),onSuccess:()=>{Y.invalidateQueries({queryKey:["img"]})},onError:o=>{ye.error(o.message)}},Y),w=Z({mutationFn:o=>ot(o.full_picture_id,o.country,o.language,o.value,o.format,o.topic,o.color,o.left,o.right,o.top,o.bottom),onSuccess:()=>{Y.invalidateQueries({queryKey:["img"]})}},Y);Z({mutationFn:o=>Je(o.token,o.full_picture_id),onError:o=>{ye.error(o.message)}},Y);const v=Z({mutationFn:o=>at(o.full_picture_id),onSuccess:o=>{ye.success(o.data)}},Y),I=o=>{v.mutate({full_picture_id:o})},V=(o,s,i)=>{const R=[...b];R[o]={x:i.x,y:i.y},O(R)},$=(o,s)=>{const i=[...F];i[o]=s.target.value,re(i)},H=(o,s)=>{const i=[...z];i[o]=parseInt(s.target.value,10),A(i)},oe=(o,s)=>{const i=[...c];i[o]=s.target.value,u(i)},me=(o,s)=>{const i=b[s];if(i){const{x:R,y:K}=i;o&&p.mutate({picture_id:o,country:n[s],language:a[s],value:d[s],format:h[s],topic:y[s],color:c[s],left:R.toString(),right:(R+10).toString(),top:K.toString(),bottom:(K+5).toString()})}},ae=(o,s)=>{const i=b[s];if(i){const{x:R,y:K}=i;o&&w.mutate({full_picture_id:o,country:n[s],language:a[s],value:d[s],format:h[s],topic:y[s],color:c[s],left:R.toString(),right:(R+10).toString(),top:K.toString(),bottom:(K+5).toString()})}},se=(o,s)=>{const i=[...n];i[o]=s,r(i)},Ce=(o,s)=>{const i=[...a];i[o]=s,l(i)},ie=(o,s)=>{const i=[...d];i[o]=s,m(i)},le=(o,s)=>{const i=[...h];i[o]=s,S(i)},ce=(o,s)=>{const i=[...y];i[o]=s,_(i)};return f.jsx("div",{className:C.mainBox,children:e&&e.map((o,s)=>f.jsxs("div",{className:C.redactorBox,children:[f.jsxs("div",{className:C.draggableImgBox,children:[f.jsx(Dn,{position:b[s],onDrag:(i,R)=>V(s,i,R),bounds:"parent",children:f.jsx("div",{ref:g.current[s],className:C.draggableBox,style:{fontSize:`${z[s]}px`,color:c[s]},children:F[s]})}),f.jsx("img",{className:C.redactorImg,src:o.url,alt:`img-${s}`})]}),f.jsx("input",{className:C.redactorIn,type:"text",placeholder:"Label",value:F[s]||"",onChange:i=>$(s,i)}),f.jsx("input",{className:C.redactorIn,type:"number",value:z[s],onChange:i=>H(s,i),placeholder:"Text Size"}),f.jsx("input",{className:C.redactorIn,type:"color",value:c[s],onChange:i=>oe(s,i),placeholder:"Text Color"}),f.jsxs("ul",{className:`${C.topbar}`,children:[f.jsx("li",{className:C.defaultSelect,children:f.jsx(Q,{defaultValue:t("Country"),onChange:i=>se(s,i),value:n[s],items:[{value:"en",content:"en",id:"1"},{value:"ru",content:"ru",id:"2"},{value:"fr",content:"fr",id:"3"}]})}),f.jsx("li",{className:C.defaultSelect,children:f.jsx(Q,{defaultValue:t("Language"),onChange:i=>Ce(s,i),value:a[s],items:[{value:"en",content:"English",id:"1"},{value:"ru",content:"Русский",id:"2"},{value:"fr",content:"Française",id:"3"}]})}),f.jsx("li",{className:C.defaultSelect,children:f.jsx(Q,{defaultValue:t("Currency"),value:d[s],onChange:i=>ie(s,i),items:[{value:"en",content:"English",id:"1"}]})}),f.jsx("li",{className:C.defaultSelect,children:f.jsx(Q,{defaultValue:t("Banner format"),value:h[s],onChange:i=>le(s,i),items:[{value:"300*300",content:"300*300",id:"1"},{value:"600*600",content:"600*600",id:"2"},{value:"900*900",content:"900*900",id:"3"}]})}),f.jsx("li",{className:`${C.defaultSelect} ${C.lastDefaultSelect}`,children:f.jsx(Q,{defaultValue:t("Banner theme"),value:y[s],onChange:i=>ce(s,i),items:[{value:"footbal",content:"footbal",id:"1"}]})})]}),o.picture_id?f.jsx(ee,{className:C.adminRedactorButton,onClick:()=>me(o.picture_id,s),children:"Отправить"}):f.jsx(ee,{className:C.adminRedactorButton,onClick:()=>ae(o.full_picture_id,s),children:"Изменить"}),o.full_picture_id&&f.jsx(f.Fragment,{children:f.jsx(ee,{onClick:()=>I(o.full_picture_id),children:"Опубликовать"})})]},s))})};function On(){const e=Be(ze),[t,n]=x.useState(),r=Qe({queryKey:["img"],queryFn:()=>nt(),enabled:!!(e!=null&&e.is_admin),retry:1},Y);return x.useEffect(()=>{r.data&&n(r.data)},[r.data]),f.jsx(f.Fragment,{children:f.jsxs("div",{className:et.adminPanelBlock,children:[f.jsx(St,{}),f.jsx(bn,{images:t})]})})}export{On as default};
