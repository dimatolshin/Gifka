import{j as e,r as c,a as z,g as L,k as G,b as R,c as $,t as B,L as H,q as E,l as D,m as U}from"./index-bff7c930.js";import{B as y}from"./Button-b0ebb98f.js";import{u as M,t as I,L as V,R as Z}from"./AuthType-8ab30037.js";import{a as O,r as q}from"./authUser-dc47f5c4.js";import{u as J}from"./useTranslation-10880ada.js";const K="_boxSwitch_1kdru_1",Q="_btnSwitch_1kdru_4",W="_stroke_1kdru_9",X="_lineBreack_1kdru_14",Y="_and_1kdru_20",ee="_boxGoogle_1kdru_28",se="_googleAuth_1kdru_28",ae="_authDescr_1kdru_35",g={boxSwitch:K,btnSwitch:Q,stroke:W,lineBreack:X,and:Y,boxGoogle:ee,googleAuth:se,authDescr:ae};function oe(){return e.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M13.9168 7.64424C13.9168 7.22181 13.8785 6.82077 13.813 6.43042H7.6394V8.84202H11.1742C11.0157 9.63341 10.5514 10.3018 9.86297 10.7563V12.3605H11.9718C13.2065 11.2429 13.9168 9.59598 13.9168 7.64424Z",fill:"#4285F4"}),e.jsx("path",{d:"M7.63954 13.9165C9.40966 13.9165 10.8902 13.339 11.972 12.3605L9.86311 10.7563C9.27308 11.1413 8.5246 11.3766 7.63954 11.3766C5.92953 11.3766 4.48175 10.2483 3.96273 8.72437H1.78833V10.3767C2.8646 12.4728 5.07725 13.9165 7.63954 13.9165Z",fill:"#34A853"}),e.jsx("path",{d:"M3.96266 8.72436C3.82608 8.33936 3.75506 7.92763 3.75506 7.49985C3.75506 7.07207 3.83155 6.66034 3.96266 6.27534V4.62305H1.78826C1.34027 5.4893 1.0835 6.46249 1.0835 7.49985C1.0835 8.53721 1.34027 9.51041 1.78826 10.3767L3.96266 8.72436Z",fill:"#FBBC05"}),e.jsx("path",{d:"M7.63954 3.62318C8.60655 3.62318 9.46975 3.94936 10.1527 4.58568L12.0211 2.75693C10.8902 1.71957 9.40966 1.08325 7.63954 1.08325C5.07725 1.08325 2.8646 2.527 1.78833 4.62311L3.96273 6.27541C4.48175 4.75145 5.92953 3.62318 7.63954 3.62318Z",fill:"#EA4335"})]})}const te="_form_z9p43_1",re="_formTitle_z9p43_15",ne="_btnSub_z9p43_21",le="_boxForgot_z9p43_29",ce="_forgotPass_z9p43_36",ie="_error_z9p43_44",h={form:te,formTitle:re,btnSub:ne,boxForgot:le,forgotPass:ce,error:ie};function me(){var v,l;const[t,r]=c.useState(!1),[a,n]=c.useState(!1),m=z(L),f=G(),j=R(),S=()=>{r(s=>!s)},p=$({mutationFn:s=>O(s.email,s.password),onSuccess:s=>{j(B.initAuthData(s)),k()}},E),{register:i,handleSubmit:w,formState:{errors:d},reset:k,setValue:b}=M({resolver:I(V)});c.useEffect(()=>{const s=localStorage.getItem("email"),N=localStorage.getItem("password");s&&N&&(b("email",s),b("password",N),n(!0))},[b]);const x=()=>{n(s=>!s)},_=s=>{a?(localStorage.setItem("email",s.email),localStorage.setItem("password",s.password)):(localStorage.removeItem("email"),localStorage.removeItem("password")),p.mutate({email:s.email,password:s.password})};return c.useEffect(()=>{m&&f("/")},[m]),e.jsxs("form",{className:h.form,onSubmit:w(_),children:[e.jsxs("label",{children:[e.jsx("span",{className:h.formTitle,children:"Email"}),e.jsx("input",{className:`input ${d.email?"border-danger":""}`,placeholder:"email@email.com",type:"email",autoComplete:"username",...i("email")}),d&&e.jsx("span",{className:h.error,children:(v=d.email)==null?void 0:v.message})]}),e.jsxs("label",{children:[e.jsxs("div",{className:h.boxForgot,children:[e.jsx("span",{className:h.formTitle,children:"Password"}),e.jsx(H,{to:"forgot",className:h.forgotPass,children:"Forgot Password?"})]}),e.jsxs("div",{className:`input max-w-72 ${d.password?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"current-password",placeholder:"Enter Password",type:t?"text":"password",...i("password")}),e.jsx("div",{onClick:S,className:"btn btn-icon","data-toggle-password-trigger":"true",children:t?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),d&&e.jsx("span",{className:h.error,children:(l=d.password)==null?void 0:l.message})]}),e.jsxs("label",{className:"form-label flex items-center gap-2.5",children:[e.jsx("input",{className:"checkbox",name:"check",type:"checkbox",value:"1",checked:a,onChange:x}),"Remember me"]}),p.error&&e.jsx("span",{className:h.error,children:p.error.message}),e.jsx(y,{isLoading:p.isPending,className:h.btnSub,children:"Sign in"})]})}const de="_form_z9p43_1",ue="_formTitle_z9p43_15",ge="_btnSub_z9p43_21",he="_boxForgot_z9p43_29",pe="_forgotPass_z9p43_36",xe="_error_z9p43_44",u={form:de,formTitle:ue,btnSub:ge,boxForgot:he,forgotPass:pe,error:xe};function fe(){var N,F,A,T;J();const[t,r]=c.useState(!1),[a,n]=c.useState(!1),[m,f]=c.useState(!1),[j,S]=c.useState(null),[p,i]=c.useState(""),w=z(L),d=G(),k=()=>{r(o=>!o)},b=()=>{f(o=>!o)},x=$({mutationFn:o=>q(o.email,o.password,o.re_password,o.username),onSuccess:()=>{n(!0),S(null),s()},onError:o=>{const C=Object.keys(o).map(P=>`${P}: ${o[P]}`).join(", ");console.log(C),S(C)}},E),{register:_,handleSubmit:v,formState:{errors:l},reset:s}=M({resolver:I(Z)});return c.useEffect(()=>{a&&!j&&(d("/auths/check",{state:{emailName:p}}),n(!1))},[a,j]),c.useEffect(()=>{w&&d("/")},[w]),e.jsxs("form",{className:u.form,onSubmit:v(({email:o,password:C,confirmPassword:P})=>{x.mutate({email:o,password:C,re_password:P,username:o}),i(o)}),children:[e.jsxs("label",{children:[e.jsx("span",{className:u.formTitle,children:"Email"}),e.jsx("input",{autoComplete:"username",className:`input ${l.email?"border-danger":""}`,placeholder:"email@email.com",type:"email",..._("email")}),l&&e.jsx("span",{className:u.error,children:(N=l.email)==null?void 0:N.message})]}),e.jsxs("label",{children:[e.jsx("span",{className:u.formTitle,children:"Password"}),e.jsxs("div",{className:`input max-w-72 ${l.password?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"new-password",placeholder:"Enter Password",type:t?"text":"password",..._("password")}),e.jsx("div",{onClick:k,className:"btn btn-icon","data-toggle-password-trigger":"true",children:t?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),l&&e.jsx("span",{className:u.error,children:(F=l.password)==null?void 0:F.message})]}),e.jsxs("label",{children:[e.jsx("span",{className:u.formTitle,children:"Confirm Password"}),e.jsxs("div",{className:`input max-w-72 ${l.confirmPassword?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"new-password",placeholder:"Re-enter Password",type:m?"text":"password",..._("confirmPassword")}),e.jsx("div",{onClick:b,className:"btn btn-icon","data-toggle-password-trigger":"true",children:m?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),l&&e.jsx("span",{className:u.error,children:(A=l.confirmPassword)==null?void 0:A.message})]}),e.jsxs("label",{className:"form-label flex items-center gap-2.5",children:[e.jsx("input",{..._("consent"),className:"checkbox",type:"checkbox",defaultChecked:!0}),e.jsx("p",{children:"I accept Terms & Conditions"})]}),l&&e.jsx("span",{className:u.error,children:(T=l.consent)==null?void 0:T.message}),x.error&&e.jsx("span",{className:u.error,children:x.error.message}),e.jsx(y,{isLoading:x.isPending,type:"submit",className:u.btnSub,children:"Sign up"})]})}const we="https://bwcreatorhub.com";function be(t){return D.get("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${t.access_token}`}}).then(r=>{const a=r.data.email,n=r.data.given_name,m=r.data.family_name,f=r.data.sub;return{email:a,username:n,lastname:m,id:f}}).catch(r=>{if(r)throw new Error("Ошибка")})}function je(t,r){return D.post(`${we}/api/google_auth/`,{email:t,username:r}).then(a=>{const n=a.data.token;return console.log(n),n}).catch(a=>{const n=Object.keys(a.response.data).map(m=>`${a.response.data[m]}`).join(", ");throw new Error(n)})}function Ce(){const[t,r]=c.useState("auth"),[a,n]=c.useState(),m=R(),f=()=>{r(i=>i==="register"?"auth":"register")},j=$({mutationFn:i=>je(i.email,i.username),onSuccess:i=>{m(B.initAuthData(i))}},E);c.useEffect(()=>{a&&j.mutate({email:a.email,username:a.email})},[a]);const p=U({onSuccess:async i=>{const w=await be(i);if(w){const{email:d,username:k,lastname:b,id:x}=w;n({email:d,username:k,lastname:b,id:x})}}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:g.boxSwitch,children:[e.jsx("h1",{children:t==="auth"?"Sign in":"Sign up"}),e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("p",{className:"mr-1",children:t==="auth"?"Need an account?":"Already have an Account?"}),e.jsx(y,{className:g.btnSwitch,onClick:f,children:t==="auth"?"Sign up":"Sign in"})]})]}),e.jsx("div",{className:g.boxGoogle,children:e.jsxs(y,{onClick:()=>p(),className:g.googleAuth,children:[e.jsx(oe,{}),e.jsx("p",{className:g.authDescr,children:"Use Google"})]})}),e.jsxs("div",{className:g.stroke,children:[e.jsx("div",{className:g.lineBreack}),e.jsx("p",{className:g.and,children:"OR"}),e.jsx("div",{className:g.lineBreack})]}),t==="auth"?e.jsx(me,{}):e.jsx(fe,{})]})}export{Ce as default};
