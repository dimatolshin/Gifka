import{u as j,g as S,r as g,b as L,t as D,j as e,a as I}from"./index-a9b442b5.js";import{B as x}from"./Button-df9c9e72.js";import{h as P,j as v,q as k}from"./queryClient-ddd1e2ac.js";import{d as M,s as R,a as K,b as Q}from"./authUser-e3f35a71.js";import{u as E,t as T,d as V,s as J}from"./AuthType-1d0755e7.js";import{L as W}from"./ListBox-f4ecf11b.js";import{_ as z}from"./index-97f3b16a.js";import"./classNames-3b7f1560.js";const X="_deleteBtn_ne8hy_1",Y="_cancel_ne8hy_14",Z="_error_ne8hy_27",w={deleteBtn:X,cancel:Y,error:Z};function ee(){var b;const{t:s}=P(),r=j(S),[t,u]=g.useState(!1),[l,c]=g.useState(!1),d=L(),p=v({mutationFn:h=>M(h.password,h.token),onSuccess:()=>{d(D.logout())}},k),{register:i,handleSubmit:_,formState:{errors:a},reset:f}=E({resolver:T(V)}),C=()=>{c(h=>!h)},m=()=>{u(h=>!h),f()};return e.jsxs("div",{children:[e.jsx(x,{className:t?w.cancel:w.deleteBtn,onClick:m,children:t?"Отмена":s("Delete account")}),t&&e.jsxs("form",{className:w.form,onSubmit:_(({password:h})=>{p.mutate({password:h,token:r})}),children:[e.jsxs("label",{className:w.label,children:[e.jsx("span",{className:w.formTitle,children:"Password"}),e.jsxs("div",{className:`input max-w-72 ${a.password?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"password",placeholder:"Enter Password",type:l?"text":"password",...i("password")}),e.jsx("div",{onClick:C,className:"btn btn-icon","data-toggle-password-trigger":"true",children:l?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),a&&e.jsx("span",{className:w.error,children:s((b=a.password)==null?void 0:b.message)})]}),p.error&&e.jsx("span",{className:w.error,children:p.error.message}),e.jsx(x,{className:w.deleteBtn,isLoading:p.isPending,children:"Delete"})]})]})}const se="_langBox_f8w2s_1",te="_descr_f8w2s_6",H={langBox:se,descr:te};function ae(){const{t:s,i18n:r}=P(),t=r.language,u=d=>{r.changeLanguage(d)},l=[{value:"en",content:"English",id:"1",disabled:t==="en"},{value:"ru",content:"Русский",id:"2",disabled:t==="ru"},{value:"fr",content:"Français",id:"3",disabled:t==="fr"},{value:"es",content:"Español",id:"4",disabled:t==="es"},{value:"pr",content:"Português",id:"5",disabled:t==="pr"}],c=l.find(d=>d.value===t);return e.jsxs("div",{className:H.langBox,children:[e.jsxs("p",{className:H.descr,children:[s("Language"),":"]}),e.jsx(W,{defaultValue:c?c.content:s("Language"),onChange:u,items:l})]})}const oe="_btn_7watp_1",ne="_change_7watp_14",re="_label_7watp_27",le="_error_7watp_34",n={btn:oe,change:ne,label:re,error:le};function ce(){var $,B,F;const{t:s}=P(),r=j(S),[t,u]=g.useState(!1),[l,c]=g.useState(!1),[d,p]=g.useState(!1),[i,_]=g.useState(!1),a=v({mutationFn:o=>R(o.new_password,o.re_new_password,o.old_password,o.token),onSuccess:()=>{u(!1),z.success("Пароль успешно изменён"),b()}},k),{register:f,handleSubmit:C,formState:{errors:m},reset:b}=E({resolver:T(J)}),h=()=>{c(o=>!o)},A=()=>{p(o=>!o)},O=()=>{_(o=>!o)},U=()=>{u(o=>!o),b()};return e.jsxs("div",{children:[e.jsx(x,{className:t?n.change:n.btn,onClick:U,children:t?"Отмена":s("Change password")}),t&&e.jsxs("form",{className:n.form,onSubmit:C(({old_password:o,password:q,confirmPassword:G})=>{a.mutate({new_password:q,re_new_password:G,old_password:o,token:r})}),children:[e.jsxs("label",{className:n.label,children:[e.jsx("span",{className:n.formTitle,children:"Old Password"}),e.jsxs("div",{className:`input max-w-72 ${m.old_password?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"new-password",placeholder:"Old Password",type:l?"text":"password",...f("old_password")}),e.jsx("div",{onClick:h,className:"btn btn-icon","data-toggle-password-trigger":"true",children:l?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),m&&e.jsx("span",{className:n.error,children:s(($=m.old_password)==null?void 0:$.message)})]}),e.jsxs("label",{className:n.label,children:[e.jsx("span",{className:n.formTitle,children:"Password"}),e.jsxs("div",{className:`input max-w-72 ${m.password?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"new-password",placeholder:"Enter Password",type:d?"text":"password",...f("password")}),e.jsx("div",{onClick:A,className:"btn btn-icon","data-toggle-password-trigger":"true",children:d?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),m&&e.jsx("span",{className:n.error,children:s((B=m.password)==null?void 0:B.message)})]}),e.jsxs("label",{className:n.label,children:[e.jsx("span",{className:n.formTitle,children:"Confirm Password"}),e.jsxs("div",{className:`input max-w-72 ${m.confirmPassword?"border-danger":""}`,"data-toggle-password":"true",children:[e.jsx("input",{autoComplete:"new-password",placeholder:"Re-enter Password",type:i?"text":"password",...f("confirmPassword")}),e.jsx("div",{onClick:O,className:"btn btn-icon","data-toggle-password-trigger":"true",children:i?e.jsx("i",{className:"ki-outline ki-eye-slash toggle-password-active:block"}):e.jsx("i",{className:"ki-outline ki-eye toggle-password-active:hidden"})})]}),m&&e.jsx("span",{className:n.error,children:s((F=m.confirmPassword)==null?void 0:F.message)})]}),a.error&&e.jsx("span",{className:n.error,children:a.error.message}),e.jsx(x,{isLoading:a.isPending,className:n.btn,children:"Submit"})]})]})}const de="_deleteBtn_1cn99_1",ie="_cancel_1cn99_14",y={deleteBtn:de,cancel:ie};function me(){const{t:s}=P(),[r,t]=g.useState(!1),u=L(),l=j(S),c=()=>{t(i=>!i)},d=v({mutationFn:i=>K(i.token),onSuccess:()=>{u(D.logout())}},k),p=()=>{d.mutate({token:l})};return e.jsxs("div",{children:[e.jsx(x,{className:r?y.cancel:y.deleteBtn,onClick:c,children:r?"Отмена":s("Delete account")}),r&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Подтвердите удаление"}),e.jsx(x,{onClick:p,className:y.deleteBtn,children:s("Delete account")})]})]})}const ue="_btn_14wzf_1",pe="_change_14wzf_14",he="_modalInput_14wzf_27",ge="_label_14wzf_32",we="_error_14wzf_39",N={btn:ue,change:pe,modalInput:he,label:ge,error:we};function xe(){const s=j(I),r=j(S),{t}=P(),[u,l]=g.useState(""),[c,d]=g.useState(!1),p=()=>{d(a=>!a)},i=v({mutationFn:a=>Q(a.token,a.promocode),onSuccess:a=>{z.success(a),k.invalidateQueries({queryKey:["user"]})}},k),_=()=>{i.mutate({token:r,promocode:u})};return e.jsxs("div",{children:[e.jsx("p",{children:`${t("My promo code")}: ${s==null?void 0:s.promocode}`}),e.jsx(x,{className:c?N.change:N.btn,onClick:p,children:c?"Отмена":t("Change promo code")}),c&&e.jsxs("div",{children:[e.jsxs("label",{className:N.label,htmlFor:"",children:[e.jsx("span",{children:"Promocode"}),e.jsx("div",{className:"input max-w-72","data-toggle-password":"true",children:e.jsx("input",{autoComplete:"promo",placeholder:"Promocode",type:"text",onChange:a=>l(a.target.value),maxLength:15})})]}),e.jsx(x,{onClick:_,className:N.btn,children:t("Change promo code")})]}),i.error&&e.jsx("span",{className:N.error,children:i.error.message})]})}function ve(){const s=j(I);return e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsx(xe,{}),s!=null&&s.is_google_profile?e.jsx(me,{}):e.jsxs("div",{children:[e.jsx(ce,{}),e.jsx(ee,{})]})]})}export{ve as default};
